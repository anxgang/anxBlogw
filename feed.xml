<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.1">Jekyll</generator><link href="https://blog.anxgang.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://blog.anxgang.com/" rel="alternate" type="text/html" /><updated>2023-01-04T10:55:20+08:00</updated><id>https://blog.anxgang.com/feed.xml</id><title type="html">ANxGANG</title><subtitle>A simple Blog</subtitle><author><name>anxgang</name></author><entry><title type="html">Jekyll ä½¿ç”¨ private repository å»ºç«‹ gh-pages</title><link href="https://blog.anxgang.com/jekyll/private-repo-with-gh-pages/" rel="alternate" type="text/html" title="Jekyll ä½¿ç”¨ private repository å»ºç«‹ gh-pages" /><published>2023-01-04T00:00:00+08:00</published><updated>2023-01-04T00:00:00+08:00</updated><id>https://blog.anxgang.com/jekyll/private-repo-with-gh-pages</id><content type="html" xml:base="https://blog.anxgang.com/jekyll/private-repo-with-gh-pages/"><![CDATA[<p>å…è²»ç‰ˆçš„ github å»ºç«‹ gh-pages å¿…é ˆå…¬é–‹ repositoryã€‚
å¦‚æœæƒ³çœéŒ¢åˆä¸æƒ³æŠŠ markdown ç›´æ¥å…¬è«¸æ–¼ä¸–è©²æ€éº¼è¾¦ï¼Ÿ</p>

<h2 id="ç›®æ¨™">ç›®æ¨™</h2>

<p>æœ¬æ–‡ä½¿ç”¨ jekyll ï¼Œ
é€éä¸€å€‹ private repository (åŸå§‹ç¢¼)ï¼Œ
æ­é…ä¸€å€‹ public repository (ç”¢å‡ºçš„ html)ï¼Œ
ä¾†é”åˆ°ç›®æ¨™ã€‚</p>

<pre><code class="language-mermaid">graph TD
    A[source code] --&gt;|git push| B(private repo)
    B --&gt;|github action auto deploy| D[public repo]
</code></pre>

<h2 id="æ­¥é©Ÿ">æ­¥é©Ÿ</h2>

<ol>
  <li>å…ˆåˆ° github ä¸Šå»ºç«‹å¥½å…©å€‹ repo ã€‚ä¾‹å¦‚ï¼šmyblog_private, myblog_public,</li>
  <li>åŠ å…¥ github actionï¼Œä¸¦ push åˆ° myblog_private
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># .github/workflows/jekyll.yml</span>
 <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy Jekyll site to Pages</span>
 <span class="na">on</span><span class="pi">:</span>
   <span class="na">push</span><span class="pi">:</span>
     <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">main"</span><span class="pi">]</span>
   <span class="na">workflow_dispatch</span><span class="pi">:</span>
 <span class="na">permissions</span><span class="pi">:</span>
   <span class="na">contents</span><span class="pi">:</span> <span class="s">read</span>
   <span class="na">pages</span><span class="pi">:</span> <span class="s">write</span>
   <span class="na">id-token</span><span class="pi">:</span> <span class="s">write</span>
 <span class="na">concurrency</span><span class="pi">:</span>
   <span class="na">group</span><span class="pi">:</span> <span class="s2">"</span><span class="s">pages"</span>
   <span class="na">cancel-in-progress</span><span class="pi">:</span> <span class="no">true</span>
 <span class="na">jobs</span><span class="pi">:</span>
   <span class="na">deploy</span><span class="pi">:</span>
     <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
     <span class="na">steps</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup Ruby</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">ruby/setup-ruby@v1</span>
         <span class="na">with</span><span class="pi">:</span>
           <span class="na">ruby-version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.0'</span>
           <span class="na">bundler-cache</span><span class="pi">:</span> <span class="no">true</span>
           <span class="na">cache-version</span><span class="pi">:</span> <span class="m">0</span> <span class="c1"># Increment this number if you need to re-download cached gems</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build with Jekyll</span>
         <span class="na">run</span><span class="pi">:</span> <span class="s">bundle exec jekyll build</span>
         <span class="na">env</span><span class="pi">:</span>
           <span class="na">JEKYLL_ENV</span><span class="pi">:</span> <span class="s">production</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload artifact</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-pages-artifact@v1</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to GitHub Pages ğŸš€</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">peaceiris/actions-gh-pages@v3</span>
         <span class="na">with</span><span class="pi">:</span>
           <span class="na">deploy_key</span><span class="pi">:</span> <span class="s">${{ secrets.ACTIONS_DEPLOY_KEY }}</span>
           <span class="na">external_repository</span><span class="pi">:</span> <span class="s">mygithub/myblog_public</span>
           <span class="na">publish_branch</span><span class="pi">:</span> <span class="s">main</span>
           <span class="na">publish_dir</span><span class="pi">:</span> <span class="s">./_site</span>
</code></pre></div>    </div>
  </li>
  <li>ç”¢ç”Ÿä¸€çµ„ gh-pages å°ˆç”¨çš„ public key å’Œ private key
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096 <span class="nt">-C</span> <span class="s2">"</span><span class="si">$(</span>git config user.email<span class="si">)</span><span class="s2">"</span> <span class="nt">-f</span> gh-pages <span class="nt">-N</span> <span class="s2">""</span>
</code></pre></div>    </div>
    <ul>
      <li>public key: gh-pages.pub</li>
      <li>private key: gh-pages</li>
    </ul>
  </li>
  <li>æŠŠ private key åŠ åˆ° private repo çš„ secerts ä¸­ï¼Œä¸¦å–åç‚º <code class="language-plaintext highlighter-rouge">ACTIONS_DEPLOY_KEY</code></li>
  <li>æŠŠ public key åŠ åˆ° public repo çš„ deploy keys ä¸­</li>
</ol>

<h2 id="åƒè€ƒ">åƒè€ƒ</h2>
<ol>
  <li><a href="https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-deploy-to-external-repository-external_repository" target="_blank">deploy-to-external-repository</a></li>
  <li><a href="https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-create-ssh-deploy-key" target="_blank">create-ssh-deploy-key</a></li>
</ol>]]></content><author><name>anxgang</name></author><category term="Jekyll" /><category term="jekyll" /><category term="github" /><category term="gh-pages" /><summary type="html"><![CDATA[å…è²»ç‰ˆçš„ github å»ºç«‹ gh-pages å¿…é ˆå…¬é–‹ repositoryã€‚ å¦‚æœæƒ³çœéŒ¢åˆä¸æƒ³æŠŠ markdown ç›´æ¥å…¬è«¸æ–¼ä¸–è©²æ€éº¼è¾¦ï¼Ÿ]]></summary></entry></feed>