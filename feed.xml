<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://blog.anxgang.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://blog.anxgang.com/" rel="alternate" type="text/html" /><updated>2024-03-24T00:27:32+08:00</updated><id>https://blog.anxgang.com/feed.xml</id><title type="html">ANxGANG</title><subtitle>A simple Blog</subtitle><author><name>anxgang</name></author><entry><title type="html">å¦‚ä½•ä½¿ç”¨è‡ªå®šç¾©çš„ iso å»ºç«‹ Linode</title><link href="https://blog.anxgang.com/ubuntu/how-to-create-linodes-with-custom-iso/" rel="alternate" type="text/html" title="å¦‚ä½•ä½¿ç”¨è‡ªå®šç¾©çš„ iso å»ºç«‹ Linode" /><published>2023-02-04T00:00:00+08:00</published><updated>2023-02-04T00:00:00+08:00</updated><id>https://blog.anxgang.com/ubuntu/how-to-create-linodes-with-custom-iso</id><content type="html" xml:base="https://blog.anxgang.com/ubuntu/how-to-create-linodes-with-custom-iso/"><![CDATA[<p>å¦‚ä½•ä½¿ç”¨è‡ªå®šç¾©çš„ iso å»ºç«‹ Linode</p>

<h2 id="ç›®æ¨™">ç›®æ¨™</h2>

<p>ä½¿ç”¨ proxmox iso ä¾†èˆ‰ä¾‹ï¼Œå»ºç«‹ä¸€å€‹ Linode</p>

<h2 id="æ­¥é©Ÿ">æ­¥é©Ÿ</h2>

<ol>
  <li>å»ºç«‹ linode æ™‚ï¼ŒæŠŠ images å…ˆæŒ‰ x æ‰</li>
  <li>æ¥ä¸‹ä¾†é€²å…¥ linode è¨­å®šï¼Œé€²åˆ° storage é é¢ï¼Œæ‰‹å‹•å»ºç«‹ä¸€å€‹(label:Installer/type:raw/size:3000mb)</li>
  <li>æŒ‰å³ä¸Šè§’çš„â€¦ï¼Œé¸æ“‡ rescue ä½¿ç”¨å®‰å…¨æ¨¡å¼é–‹å•Ÿ(/dev/sda é¸æ“‡å‰›å‰›å»ºç«‹çš„ Installer)</li>
  <li>é–‹å•Ÿ LISH Console åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤å°‡ ISO ç›´æ¥å¯«å…¥åˆ° Installer ä¸­
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span>wget https://enterprise.proxmox.com/iso/proxmox-ve_7.3-1.iso
  <span class="nv">$ </span><span class="nb">dd </span><span class="k">if</span><span class="o">=</span>proxmox-ve_7.3-1.iso <span class="nv">of</span><span class="o">=</span>/dev/sda
</code></pre></div>    </div>
    <p>or</p>
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span>curl https://enterprise.proxmox.com/iso/proxmox-ve_7.3-1.iso | <span class="nb">dd </span><span class="nv">of</span><span class="o">=</span>/dev/sda
</code></pre></div>    </div>
  </li>
  <li>å®‰è£å®Œæˆå¾Œï¼Œåˆ‡åˆ° storage é é¢ï¼Œå†å¦å¤–å»ºä¸€å€‹ç¡¬ç¢Ÿ(label:System/type:ext4/size:20000mb)</li>
  <li>åœ¨ storage ä½¿ç”¨ Installer é–‹æ©Ÿ</li>
  <li>é–‹å•Ÿ  LISH Console åˆ‡åˆ° GLISH å³å¯çœ‹åˆ°å®‰è£ç•«é¢</li>
  <li>æ¥ä¸‹ä¾†å°±ç…§æ­£å¸¸å®‰è£æ–¹å¼å®‰è£</li>
  <li>å®‰è£å®Œå¾Œå°±å¯ä»¥æŠŠ installer åˆªé™¤äº†</li>
</ol>

<h2 id="åƒè€ƒ">åƒè€ƒ</h2>
<ol>
  <li><a href="https://www.linode.com/docs/products/compute/compute-instances/guides/install-a-custom-distribution/#save-the-system-as-a-custom-image" target="_blank">linode.com docs - Install a Custom Linux Distribution on a Compute Instance</a></li>
  <li><a href="https://www.cyberciti.biz/faq/add-configure-set-up-static-ip-address-on-debianlinux/" target="_blank">cyberciti.biz - Configuring Static IP on Debian 10 or 11</a></li>
  <li><a href="https://www.haiyun.me/archives/1416.html" target="_blank">haiyun.me - Proxmoxç½‘æ¡¥é€šè¿‡SLAACé…ç½®å…¬ç½‘ipv6åœ°å€</a></li>
  <li><a href="https://sakurabakiyoka.com/post/28.html" target="_blank">sakurabakiyoka.com - Proxmox å¼€IPV4 NAT+IPV6 SLAACæœº</a></li>
  <li><a href="https://www.wnark.com/archives/32.html" target="_blank">wnark.com - å•IPv4ç‹¬æœåˆ©ç”¨ProxmoxVEå»ºç«‹IPv4-NATå’ŒIPv6è™šæ‹Ÿæœºï¼ˆå°é¸¡</a></li>
  <li><a href="https://www.jkg.tw/p2531/" target="_blank">jkgtwâ€™s blog - è™›æ“¬æ©Ÿè·‘èµ·ä¾†ï¼RouterOS CHR è»Ÿè·¯ç”±æ•ˆèƒ½è¼•é¬†çªç ´ 1000Mï¼</a></li>
</ol>]]></content><author><name>anxgang</name></author><category term="Ubuntu" /><category term="ubuntu" /><category term="linode" /><category term="pve" /><summary type="html"><![CDATA[å¦‚ä½•ä½¿ç”¨è‡ªå®šç¾©çš„ iso å»ºç«‹ Linode]]></summary></entry><entry><title type="html">Ubuntu å¦‚ä½• mount windows çš„åˆ†äº«è³‡æ–™å¤¾</title><link href="https://blog.anxgang.com/ubuntu/how-to-mount-windows-share-folder-in-ubuntu-copy/" rel="alternate" type="text/html" title="Ubuntu å¦‚ä½• mount windows çš„åˆ†äº«è³‡æ–™å¤¾" /><published>2023-02-02T00:00:00+08:00</published><updated>2023-02-02T00:00:00+08:00</updated><id>https://blog.anxgang.com/ubuntu/how-to-mount-windows-share-folder-in-ubuntu%20copy</id><content type="html" xml:base="https://blog.anxgang.com/ubuntu/how-to-mount-windows-share-folder-in-ubuntu-copy/"><![CDATA[<p>ubuntu å¦‚ä½•é€£æ¥ windows çš„åˆ†äº«è³‡æ–™å¤¾</p>

<h2 id="ç›®æ¨™">ç›®æ¨™</h2>

<p>ubuntu é€£æ¥ windows çš„åˆ†äº«è³‡æ–™å¤¾</p>

<h2 id="å®‰è£">å®‰è£</h2>

<p>å®‰è£ CIFS</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>cifs-utils
</code></pre></div></div>

<p>On older systems:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>smbfs
</code></pre></div></div>

<h2 id="æ­¥é©Ÿ">æ­¥é©Ÿ</h2>

<ol>
  <li>ç¢ºä¿æ‚¨æœ‰ä»¥ä¸‹è¨Šæ¯ï¼š
    <ul>
      <li>ç”¨æ–¼åˆ†äº«è³‡æ–™å¤¾çš„ Windows åç¨±å’Œå¯†ç¢¼</li>
      <li>åˆ†äº«è³‡æ–™å¤¾é€£çµï¼ˆä¾‹å¦‚ //server/shareï¼‰æˆ– IP ä½ç½®</li>
      <li>Linux ä¸Šçš„ root æ¬Šé™</li>
    </ul>
  </li>
  <li>ä»¥ root ç™»éŒ„ Linuxï¼ˆæˆ–ä½¿ç”¨ su æˆ– sudoï¼‰</li>
  <li>å»ºç«‹æ‰€éœ€çš„æ›è¼‰é»ï¼š
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> /mnt/YOUR_PATH
</code></pre></div>    </div>
  </li>
  <li>é–‹å§‹æ›è¼‰
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  $ mount -t cifs //YOUR_SERVER/SHARE_FORDER -o username=YOUR_NAME,password=YOUR_PASSWORD /mnt/YOUR_PATH
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="ç¯„ä¾‹">ç¯„ä¾‹</h2>

<ol>
  <li>å…ˆæŠŠè¦ mount ä½ç½®çš„è³‡æ–™å¤¾å»ºå¥½
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> /mnt/my-server
</code></pre></div>    </div>
  </li>
  <li>å°‡ <code class="language-plaintext highlighter-rouge">//192.168.1.100/d$/download</code> é€™å€‹åˆ†äº«è³‡æ–™å¤¾ mount åˆ° <code class="language-plaintext highlighter-rouge">/mnt/my-server</code> (å¸³å¯†æ˜¯administrator/pwd123)
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span><span class="nb">sudo </span>mount <span class="nt">-t</span> cifs //192.168.1.100/d<span class="nv">$/</span>download <span class="nt">-o</span> <span class="nv">username</span><span class="o">=</span>administrator,password<span class="o">=</span>pwd123 /mnt/my-server
</code></pre></div>    </div>
  </li>
  <li>å¯ä»¥æŸ¥çœ‹ monut æ˜¯å¦æ­£ç¢º
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span><span class="nb">ls</span> /mnt/my-server
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="é–‹æ©Ÿè‡ªå‹•æ›è¼‰">é–‹æ©Ÿè‡ªå‹•æ›è¼‰</h2>

<p>è¨­å®šé–‹æ©Ÿè‡ªå‹•æ›è¼‰</p>

<p>éœ€ä»¥ root æ¬Šé™ç·¨è¼¯ <code class="language-plaintext highlighter-rouge">/etc/fstab</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># device   MountPoint  filesystem  parameters   dump   fsck</span>
<span class="c"># ç¯„ä¾‹1. ç„¡å¸³å¯†ç™»å…¥/å¯å¯«å…¥:</span>
//192.168.1.200/storage /mnt/share-server cifs guest,iocharset<span class="o">=</span>utf8,file_mode<span class="o">=</span>0777,dir_mode<span class="o">=</span>0777
<span class="c"># ç¯„ä¾‹2. å¸³å¯†ç™»å…¥/åªè®€:</span>
//192.168.1.100/d<span class="nv">$/</span>download /mnt/my-server cifs <span class="nv">username</span><span class="o">=</span>administrator,password<span class="o">=</span>pwd123,iocharset<span class="o">=</span>utf8
<span class="c"># ç¯„ä¾‹3. å¯†ç¢¼éœ€è¦éš±è—:</span>
<span class="c"># å¦å¤–å»ºç«‹ /home/ivan/.smbcredentials ä¸¦ä¸”ä½¿ç”¨ chmod 600</span>
<span class="c">#  ç¬¬ä¸€è¡Œ username=administrator </span>
<span class="c">#  ç¬¬äºŒè¡Œ password=pwd123</span>
//192.168.1.100/d<span class="nv">$/</span>download /mnt/my-server cifs <span class="nv">credentials</span><span class="o">=</span>/home/ivan/.smbcredentials,iocharset<span class="o">=</span>utf8
</code></pre></div></div>

<p>é©—è­‰å¯ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å…¨éƒ¨æ›è¼‰</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mount -a
</code></pre></div></div>

<h2 id="å–æ¶ˆæ›è¼‰">å–æ¶ˆæ›è¼‰</h2>

<p>æŒ‡å®šæŸå€‹</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>umount /mnt/my-server
</code></pre></div></div>

<p>å…¨éƒ¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>umount -a
</code></pre></div></div>

<h2 id="åƒè€ƒ">åƒè€ƒ</h2>
<ol>
  <li><a href="https://unix.stackexchange.com/questions/61790/copy-file-from-windows-shared-folder-to-unix" target="_blank">stackexchange.com - Copy file from Windows shared folder to Unix</a></li>
  <li><a href="https://www.cyberciti.biz/tips/how-to-mount-remote-windows-partition-windows-share-under-linux.html" target="_blank">cyberciti.biz - How to mount remote windows partition (windows share) under Linux</a></li>
  <li><a href="https://wiki.ubuntu.com/MountWindowsSharesPermanently" target="_blank">wiki.ubuntu.com - Mount Windows Shares Permanently</a></li>
</ol>]]></content><author><name>anxgang</name></author><category term="Ubuntu" /><category term="mount" /><category term="ubuntu" /><summary type="html"><![CDATA[ubuntu å¦‚ä½•é€£æ¥ windows çš„åˆ†äº«è³‡æ–™å¤¾]]></summary></entry><entry><title type="html">Ubuntu å¦‚ä½•ä½¿ç”¨æ’ç¨‹ crontab</title><link href="https://blog.anxgang.com/ubuntu/how-to-use-crontab-in-ubuntu/" rel="alternate" type="text/html" title="Ubuntu å¦‚ä½•ä½¿ç”¨æ’ç¨‹ crontab" /><published>2023-01-13T00:00:00+08:00</published><updated>2023-01-13T00:00:00+08:00</updated><id>https://blog.anxgang.com/ubuntu/how-to-use-crontab-in-ubuntu</id><content type="html" xml:base="https://blog.anxgang.com/ubuntu/how-to-use-crontab-in-ubuntu/"><![CDATA[<p>ubuntu å¦‚ä½•ä½¿ç”¨æ’ç¨‹ crontab</p>

<h2 id="ç›®æ¨™">ç›®æ¨™</h2>

<p>ä»‹ç´¹ crontab åŸºæœ¬ç”¨æ³•</p>

<h2 id="å®‰è£">å®‰è£</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>cron
</code></pre></div></div>

<h2 id="æœå‹™">æœå‹™</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo service cron status
sudo service cron start
sudo service cron restart
sudo service cron stop
</code></pre></div></div>

<p class="notice--warning"><strong>æç¤º:</strong> å®‰è£å®Œæœå‹™æœƒè‡ªå‹•å•Ÿå‹•ï¼Œæ–‡ä»¶è¨­å®šå®Œä¹Ÿä¸ç”¨é‡å•Ÿï¼Œæ‰€ä»¥é€™å¹¾è¡Œå…¶å¯¦å¾ˆå°‘ç”¨ã€‚</p>

<h2 id="ä½¿ç”¨æ–¹å¼">ä½¿ç”¨æ–¹å¼</h2>

<p>ä»¥ä¸‹å…©ç¨®æ–¹å¼:</p>

<h3 id="user">user</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-l</span> <span class="c">#åˆ—å‡º</span>
crontab <span class="nt">-r</span> <span class="c">#åˆªé™¤</span>
crontab <span class="nt">-e</span> <span class="c">#ç·¨è¼¯</span>
</code></pre></div></div>

<h3 id="root">root</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>vim /etc/crontab
</code></pre></div></div>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># åˆ† æ™‚ æ—¥ æœˆ æ˜ŸæœŸ æŒ‡ä»¤</span>
<span class="mi">0</span> <span class="mi">0</span><span class="p">,</span><span class="mi">12</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">*</span> <span class="sr">/usr/</span><span class="n">bin</span><span class="o">/</span><span class="n">certbot</span> <span class="n">renew</span> <span class="c1"># æ¯å€‹æœˆ1è™Ÿçš„0é»å’Œ12é»åŸ·è¡Œ certbot renew</span>
</code></pre></div></div>

<div class="notice--warning">
  
<p><strong>æç¤º:</strong><br />
å€‹äººæ˜¯ç¿’æ…£ç›´æ¥ç·¨è¼¯<code class="language-plaintext highlighter-rouge">/etc/crontab</code>ï¼Œå¦‚ä¸ç†Ÿæ‚‰å¯è‡³å·¥å…·ç¶²é  <a href="https://crontab.guru" target="_blank">crontab.guru</a> è©¦è©¦æ˜¯å¦æ­£ç¢º</p>

</div>

<h2 id="åƒè€ƒ">åƒè€ƒ</h2>

<ol>
  <li><a href="https://medium.com/@dkxmonster/%E6%8A%80%E8%A1%93%E7%A0%94%E7%A9%B6-ubuntu-crontab-6f780b88ed6b" target="_blank">æŠ€è¡“ç ”ç©¶ Ubuntu CronTab - DavidKross</a></li>
  <li><a href="https://crontab.guru" target="_blank">crontab.guru</a></li>
</ol>]]></content><author><name>anxgang</name></author><category term="Ubuntu" /><category term="crontab" /><category term="ubuntu" /><summary type="html"><![CDATA[ubuntu å¦‚ä½•ä½¿ç”¨æ’ç¨‹ crontab]]></summary></entry><entry><title type="html">Jekyll ä½¿ç”¨ mermaid ç¹ªè£½æµç¨‹åœ–</title><link href="https://blog.anxgang.com/jekyll/drawing-flowcharts-with-mermaid-in-jekyll/" rel="alternate" type="text/html" title="Jekyll ä½¿ç”¨ mermaid ç¹ªè£½æµç¨‹åœ–" /><published>2023-01-08T00:00:00+08:00</published><updated>2023-01-08T00:00:00+08:00</updated><id>https://blog.anxgang.com/jekyll/drawing-flowcharts-with-mermaid-in-jekyll</id><content type="html" xml:base="https://blog.anxgang.com/jekyll/drawing-flowcharts-with-mermaid-in-jekyll/"><![CDATA[<p>mermaid æ˜¯ä½¿ç”¨ JavaScript é–‹ç™¼çš„åœ–è¡¨å·¥å…·ã€‚
ä»–å—åˆ° Markdown å•Ÿç™¼ï¼Œä½¿ç”¨ç°¡æ˜“çš„æ–‡å­—å®šç¾©ï¼Œå³å¯å‹•æ…‹å»ºç«‹åœ–è¡¨ã€‚
æœ¬æ–‡ä»‹ç´¹å¦‚ä½•å°‡å…¶åµŒå…¥ Jekyll ä¹‹ä¸­ã€‚</p>

<h2 id="ç›®æ¨™">ç›®æ¨™</h2>

<p>å°‡ mermaid å¥—ä»¶åŠ å…¥ jekyllï¼Œä½¿ç”¨ Markdown çš„ç¨‹å¼å€å¡Šï¼Œå¿«é€Ÿçš„æ’°å¯«ä¸¦å»ºç«‹åœ–è¡¨</p>

<h2 id="å®‰è£">å®‰è£</h2>

<p>åœ¨é é¢ä¸Šæ’å…¥</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"module"</span><span class="nt">&gt;</span>
  <span class="k">import</span> <span class="nx">mermaid</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">https://cdn.jsdelivr.net/npm/mermaid@9/dist/mermaid.esm.min.mjs</span><span class="dl">'</span>
  <span class="nx">mermaid</span><span class="p">.</span><span class="nf">init</span><span class="p">({</span><span class="na">noteMargin</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span> <span class="dl">"</span><span class="s2">.language-mermaid</span><span class="dl">"</span><span class="p">)</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>
<!---->

<h2 id="ä½¿ç”¨æ–¹å¼">ä½¿ç”¨æ–¹å¼</h2>

<p>é€™é‚Šèˆ‰å‡ºä¸€äº›ç¯„ä¾‹ï¼Œè©³ç´°ç”¨æ³•å¯è‡³ <a href="https://mermaid.js.org/syntax/flowchart.html">mermaid å®˜ç¶²</a>æŸ¥è©¢</p>

<p>å¦å¤–ä¹Ÿæœ‰ <a href="https://mermaid.live/edit">mermaid live edit</a> å¯ä»¥ç·šä¸Šé è¦½ç”¢ç”Ÿçš„åœ–</p>

<div class="notice--warning">
  
<p><strong>ç¯„ä¾‹ï¼š</strong> ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">mermaid</code> å°‡èªæ³•å¯«åœ¨ç¨‹å¼å€å¡Šä¸­</p>

<p style="margin: 0px"><span>```mermaid</span></p>

<p style="margin: 0px">flowchart LR
<br />Â Â   A â€“&gt; B</p>

<p><span>```</span></p>

<pre><code class="language-mermaid">flowchart LR
  A --&gt; B
</code></pre>

</div>

<h3 id="æµç¨‹åœ–">æµç¨‹åœ–</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flowchart</span> <span class="no">LR</span>
  <span class="nc">A</span><span class="p">[</span><span class="nc">Start</span><span class="p">]</span> <span class="o">--&gt;</span> <span class="nc">B</span><span class="p">{</span><span class="nc">Is</span> <span class="n">it</span><span class="o">?</span><span class="p">}</span>
  <span class="nc">B</span> <span class="o">--</span> <span class="nc">Yes</span> <span class="o">--&gt;</span> <span class="nc">C</span><span class="p">[</span><span class="no">OK</span><span class="p">]</span>
  <span class="nc">C</span> <span class="o">--&gt;</span> <span class="nc">D</span><span class="p">[</span><span class="nc">Rethink</span><span class="p">]</span>
  <span class="nc">D</span> <span class="o">-.-&gt;</span> <span class="nc">B</span>
  <span class="nc">B</span> <span class="o">--</span> <span class="nc">No</span> <span class="o">----&gt;</span> <span class="nc">E</span><span class="p">[</span><span class="nc">End</span><span class="p">]</span>
</code></pre></div></div>
<pre><code class="language-mermaid">flowchart LR
  A[Start] --&gt; B{Is it?}
  B -- Yes --&gt; C[OK]
  C --&gt; D[Rethink]
  D -.-&gt; B
  B -- No ----&gt; E[End]
</code></pre>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flowchart</span> <span class="no">TD</span>
    <span class="n">c1</span><span class="o">--&gt;</span><span class="n">a2</span>
    <span class="n">subgraph</span> <span class="n">one</span>
    <span class="n">a1</span><span class="o">--&gt;</span><span class="n">a2</span>
    <span class="n">end</span>
    <span class="n">subgraph</span> <span class="n">two</span>
    <span class="n">b1</span><span class="o">--&gt;</span><span class="n">b2</span>
    <span class="n">end</span>
    <span class="n">subgraph</span> <span class="n">three</span>
    <span class="n">c1</span><span class="o">--&gt;</span><span class="n">c2</span>
    <span class="n">end</span>
</code></pre></div></div>

<pre><code class="language-mermaid">flowchart TD
    c1--&gt;a2
    subgraph one
    a1--&gt;a2
    end
    subgraph two
    b1--&gt;b2
    end
    subgraph three
    c1--&gt;c2
    end
</code></pre>

<h3 id="åºåˆ—åœ–">åºåˆ—åœ–</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sequenceDiagram</span>
    <span class="nc">Alice</span><span class="o">-&gt;&gt;</span><span class="nc">John</span><span class="o">:</span> <span class="nc">Hello</span> <span class="nc">John</span><span class="p">,</span> <span class="n">how</span> <span class="n">are</span> <span class="n">you</span><span class="o">?</span>
    <span class="nc">John</span><span class="o">--&gt;&gt;</span><span class="nc">Alice</span><span class="o">:</span> <span class="nc">Great</span><span class="o">!</span>
    <span class="nc">Alice</span><span class="o">-</span><span class="p">)</span><span class="nc">John</span><span class="o">:</span> <span class="nc">See</span> <span class="n">you</span> <span class="n">later</span><span class="o">!</span>
</code></pre></div></div>
<pre><code class="language-mermaid">sequenceDiagram
    Alice-&gt;&gt;John: Hello John, how are you?
    John--&gt;&gt;Alice: Great!
    Alice-)John: See you later!
</code></pre>

<h3 id="å¯¦é«”é—œä¿‚åœ–erd">å¯¦é«”é—œä¿‚åœ–(ERD)</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="n">title</span><span class="o">:</span> <span class="nc">Order</span> <span class="n">example</span>
<span class="o">---</span>
<span class="n">erDiagram</span>
    <span class="no">CUSTOMER</span> <span class="o">||--</span><span class="n">o</span><span class="p">{</span> <span class="no">ORDER</span> <span class="o">:</span> <span class="n">places</span>
    <span class="no">ORDER</span> <span class="o">||--|</span><span class="p">{</span> <span class="no">LINE</span><span class="o">-</span><span class="no">ITEM</span> <span class="o">:</span> <span class="n">contains</span>
    <span class="no">CUSTOMER</span> <span class="p">}</span><span class="o">|..|</span><span class="p">{</span> <span class="no">DELIVERY</span><span class="o">-</span><span class="no">ADDRESS</span> <span class="o">:</span> <span class="n">uses</span>
</code></pre></div></div>
<pre><code class="language-mermaid">---
title: Order example
---
erDiagram
    CUSTOMER ||--o{ ORDER : places
    ORDER ||--|{ LINE-ITEM : contains
    CUSTOMER }|..|{ DELIVERY-ADDRESS : uses
</code></pre>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">erDiagram</span>
    <span class="no">CUSTOMER</span> <span class="o">||--</span><span class="n">o</span><span class="p">{</span> <span class="no">ORDER</span> <span class="o">:</span> <span class="n">places</span>
    <span class="no">CUSTOMER</span> <span class="p">{</span>
        <span class="n">string</span> <span class="n">name</span>
        <span class="n">string</span> <span class="n">custNumber</span>
        <span class="n">string</span> <span class="n">sector</span>
    <span class="p">}</span>
    <span class="no">ORDER</span> <span class="o">||--|</span><span class="p">{</span> <span class="no">LINE</span><span class="o">-</span><span class="no">ITEM</span> <span class="o">:</span> <span class="n">contains</span>
    <span class="no">ORDER</span> <span class="p">{</span>
        <span class="n">int</span> <span class="n">orderNumber</span>
        <span class="n">string</span> <span class="n">deliveryAddress</span>
    <span class="p">}</span>
    <span class="no">LINE</span><span class="o">-</span><span class="no">ITEM</span> <span class="p">{</span>
        <span class="n">string</span> <span class="n">productCode</span>
        <span class="n">int</span> <span class="n">quantity</span>
        <span class="n">float</span> <span class="n">pricePerUnit</span>
    <span class="p">}</span>
</code></pre></div></div>
<pre><code class="language-mermaid">erDiagram
    CUSTOMER ||--o{ ORDER : places
    CUSTOMER {
        string name
        string custNumber
        string sector
    }
    ORDER ||--|{ LINE-ITEM : contains
    ORDER {
        int orderNumber
        string deliveryAddress
    }
    LINE-ITEM {
        string productCode
        int quantity
        float pricePerUnit
    }
</code></pre>

<h3 id="ç”˜ç‰¹åœ–">ç”˜ç‰¹åœ–</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gantt</span>
    <span class="n">title</span> <span class="nc">A</span> <span class="nc">Gantt</span> <span class="nc">Diagram</span>
    <span class="n">dateFormat</span>  <span class="no">YYYY</span><span class="o">-</span><span class="no">MM</span><span class="o">-</span><span class="no">DD</span>
    <span class="n">section</span> <span class="nc">Section</span>
    <span class="nc">A</span> <span class="n">task</span>           <span class="o">:</span><span class="n">a1</span><span class="p">,</span> <span class="mi">2023</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span><span class="p">,</span> <span class="mi">30</span><span class="n">d</span>
    <span class="nc">Another</span> <span class="n">task</span>     <span class="o">:</span><span class="n">after</span> <span class="n">a1</span>  <span class="p">,</span> <span class="mi">20</span><span class="n">d</span>
    <span class="n">section</span> <span class="nc">Another</span>
    <span class="nc">Task</span> <span class="n">in</span> <span class="n">sec</span>      <span class="o">:</span><span class="mi">2023</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">12</span>  <span class="p">,</span> <span class="mi">12</span><span class="n">d</span>
    <span class="n">another</span> <span class="n">task</span>      <span class="o">:</span> <span class="mi">24</span><span class="n">d</span>
</code></pre></div></div>
<pre><code class="language-mermaid">gantt
    title A Gantt Diagram
    dateFormat  YYYY-MM-DD
    section Section
    A task           :a1, 2023-01-01, 30d
    Another task     :after a1  , 20d
    section Another
    Task in sec      :2023-01-12  , 12d
    another task      : 24d
</code></pre>
<h3 id="åœ“é¤…åœ–">åœ“é¤…åœ–</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pie</span> <span class="n">showData</span>
    <span class="n">title</span> <span class="nc">Key</span> <span class="n">elements</span> <span class="n">in</span> <span class="nc">Product</span> <span class="nc">X</span>
    <span class="s2">"Calcium"</span> <span class="o">:</span> <span class="mf">42.96</span>
    <span class="s2">"Potassium"</span> <span class="o">:</span> <span class="mf">50.05</span>
    <span class="s2">"Magnesium"</span> <span class="o">:</span> <span class="mf">10.01</span>
    <span class="s2">"Iron"</span> <span class="o">:</span>  <span class="mi">5</span>
</code></pre></div></div>
<pre><code class="language-mermaid">pie showData
    title Key elements in Product X
    "Calcium" : 42.96
    "Potassium" : 50.05
    "Magnesium" : 10.01
    "Iron" :  5
</code></pre>

<h3 id="git-åœ–">Git åœ–</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="n">title</span><span class="o">:</span> <span class="nc">Example</span> <span class="nc">Git</span> <span class="n">diagram</span>
<span class="o">---</span>
<span class="n">gitGraph</span>
   <span class="n">commit</span>
   <span class="n">commit</span>
   <span class="n">branch</span> <span class="n">develop</span>
   <span class="n">checkout</span> <span class="n">develop</span>
   <span class="n">commit</span>
   <span class="n">commit</span>
   <span class="n">checkout</span> <span class="n">main</span>
   <span class="n">merge</span> <span class="n">develop</span>
   <span class="n">commit</span> <span class="n">id</span><span class="o">:</span> <span class="s2">"Normal"</span> <span class="n">tag</span><span class="o">:</span> <span class="s2">"v1.0.0"</span>
   <span class="n">commit</span> <span class="n">id</span><span class="o">:</span> <span class="s2">"Reverse"</span> <span class="n">type</span><span class="o">:</span> <span class="no">REVERSE</span> <span class="n">tag</span><span class="o">:</span> <span class="s2">"RC_1"</span>
   <span class="n">commit</span> <span class="n">id</span><span class="o">:</span> <span class="s2">"Highlight"</span> <span class="n">type</span><span class="o">:</span> <span class="no">HIGHLIGHT</span> <span class="n">tag</span><span class="o">:</span> <span class="s2">"8.8.4"</span>
</code></pre></div></div>
<pre><code class="language-mermaid">---
title: Example Git diagram
---
gitGraph
   commit
   commit
   branch develop
   checkout develop
   commit
   commit
   checkout main
   merge develop
   commit id: "Normal" tag: "v1.0.0"
   commit id: "Reverse" type: REVERSE tag: "RC_1"
   commit id: "Highlight" type: HIGHLIGHT tag: "8.8.4"
</code></pre>

<h2 id="åƒè€ƒ">åƒè€ƒ</h2>

<ol>
  <li><a href="https://mermaid.js.org/syntax/flowchart.html" target="_blank">mermaid</a></li>
  <li><a href="https://mermaid.live/" target="_blank">mermaid online playground</a></li>
</ol>]]></content><author><name>anxgang</name></author><category term="Jekyll" /><category term="jekyll" /><category term="mermaid" /><summary type="html"><![CDATA[mermaid æ˜¯ä½¿ç”¨ JavaScript é–‹ç™¼çš„åœ–è¡¨å·¥å…·ã€‚ ä»–å—åˆ° Markdown å•Ÿç™¼ï¼Œä½¿ç”¨ç°¡æ˜“çš„æ–‡å­—å®šç¾©ï¼Œå³å¯å‹•æ…‹å»ºç«‹åœ–è¡¨ã€‚ æœ¬æ–‡ä»‹ç´¹å¦‚ä½•å°‡å…¶åµŒå…¥ Jekyll ä¹‹ä¸­ã€‚]]></summary></entry><entry><title type="html">Jekyll ä½¿ç”¨ private repo å»ºç«‹ gh-pages</title><link href="https://blog.anxgang.com/jekyll/private-repo-with-gh-pages/" rel="alternate" type="text/html" title="Jekyll ä½¿ç”¨ private repo å»ºç«‹ gh-pages" /><published>2023-01-04T00:00:00+08:00</published><updated>2023-01-04T00:00:00+08:00</updated><id>https://blog.anxgang.com/jekyll/private-repo-with-gh-pages</id><content type="html" xml:base="https://blog.anxgang.com/jekyll/private-repo-with-gh-pages/"><![CDATA[<p>å…è²»ç‰ˆçš„ github å»ºç«‹ gh-pages å¿…é ˆå…¬é–‹ repositoryã€‚
å¦‚æœæƒ³çœéŒ¢åˆä¸æƒ³æŠŠ markdown ç›´æ¥å…¬è«¸æ–¼ä¸–è©²æ€éº¼è¾¦ï¼Ÿ</p>

<h2 id="ç›®æ¨™">ç›®æ¨™</h2>

<p>æœ¬æ–‡ä½¿ç”¨ jekyll ï¼Œ
é€éä¸€å€‹ private repository (åŸå§‹ç¢¼)ï¼Œ
æ­é…ä¸€å€‹ public repository (ç”¢å‡ºçš„ html)ï¼Œ
ä¾†é”åˆ°ç›®æ¨™ã€‚</p>

<pre><code class="language-mermaid">graph LR
  subgraph client
    A[source code]
  end
  A[source code] --&gt;|git push| B(private repo)
  subgraph github
    B --&gt;|"deploy(by action)"| D[public repo]
  end
</code></pre>

<h2 id="æ­¥é©Ÿ">æ­¥é©Ÿ</h2>

<ol>
  <li>å…ˆåˆ° github ä¸Šå»ºç«‹å¥½å…©å€‹ repo ã€‚ä¾‹å¦‚ï¼šmyblog_private, myblog_public,</li>
  <li>åŠ å…¥ github actionï¼Œä¸¦ push åˆ° myblog_private
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># .github/workflows/jekyll.yml</span>
 <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy Jekyll site to Pages</span>
 <span class="na">on</span><span class="pi">:</span>
   <span class="na">push</span><span class="pi">:</span>
     <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">main"</span><span class="pi">]</span>
   <span class="na">workflow_dispatch</span><span class="pi">:</span>
 <span class="na">permissions</span><span class="pi">:</span>
   <span class="na">contents</span><span class="pi">:</span> <span class="s">read</span>
   <span class="na">pages</span><span class="pi">:</span> <span class="s">write</span>
   <span class="na">id-token</span><span class="pi">:</span> <span class="s">write</span>
 <span class="na">concurrency</span><span class="pi">:</span>
   <span class="na">group</span><span class="pi">:</span> <span class="s2">"</span><span class="s">pages"</span>
   <span class="na">cancel-in-progress</span><span class="pi">:</span> <span class="kc">true</span>
 <span class="na">jobs</span><span class="pi">:</span>
   <span class="na">deploy</span><span class="pi">:</span>
     <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
     <span class="na">steps</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup Ruby</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">ruby/setup-ruby@v1</span>
         <span class="na">with</span><span class="pi">:</span>
           <span class="na">ruby-version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.0'</span>
           <span class="na">bundler-cache</span><span class="pi">:</span> <span class="kc">true</span>
           <span class="na">cache-version</span><span class="pi">:</span> <span class="m">0</span> <span class="c1"># Increment this number if you need to re-download cached gems</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build with Jekyll</span>
         <span class="na">run</span><span class="pi">:</span> <span class="s">bundle exec jekyll build</span>
         <span class="na">env</span><span class="pi">:</span>
           <span class="na">JEKYLL_ENV</span><span class="pi">:</span> <span class="s">production</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload artifact</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-pages-artifact@v1</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy to GitHub Pages ğŸš€</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">peaceiris/actions-gh-pages@v3</span>
         <span class="na">with</span><span class="pi">:</span>
           <span class="na">deploy_key</span><span class="pi">:</span> <span class="s">${{ secrets.ACTIONS_DEPLOY_KEY }}</span>
           <span class="na">external_repository</span><span class="pi">:</span> <span class="s">mygithub/myblog_public</span>
           <span class="na">publish_branch</span><span class="pi">:</span> <span class="s">main</span>
           <span class="na">publish_dir</span><span class="pi">:</span> <span class="s">./_site</span>
</code></pre></div>    </div>
  </li>
  <li>ç”¢ç”Ÿä¸€çµ„ gh-pages å°ˆç”¨çš„ public key å’Œ private key
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096 <span class="nt">-C</span> <span class="s2">"</span><span class="si">$(</span>git config user.email<span class="si">)</span><span class="s2">"</span> <span class="nt">-f</span> gh-pages <span class="nt">-N</span> <span class="s2">""</span>
</code></pre></div>    </div>
    <ul>
      <li>public key: gh-pages.pub</li>
      <li>private key: gh-pages</li>
    </ul>
  </li>
  <li>æŠŠ private key åŠ åˆ° private repo çš„ secerts ä¸­ï¼Œä¸¦å–åç‚º <code class="language-plaintext highlighter-rouge">ACTIONS_DEPLOY_KEY</code></li>
  <li>æŠŠ public key åŠ åˆ° public repo çš„ deploy keys ä¸­</li>
</ol>

<h2 id="åƒè€ƒ">åƒè€ƒ</h2>
<ol>
  <li><a href="https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-deploy-to-external-repository-external_repository" target="_blank">deploy-to-external-repository</a></li>
  <li><a href="https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-create-ssh-deploy-key" target="_blank">create-ssh-deploy-key</a></li>
</ol>]]></content><author><name>anxgang</name></author><category term="Jekyll" /><category term="jekyll" /><category term="github" /><category term="gh-pages" /><summary type="html"><![CDATA[å…è²»ç‰ˆçš„ github å»ºç«‹ gh-pages å¿…é ˆå…¬é–‹ repositoryã€‚ å¦‚æœæƒ³çœéŒ¢åˆä¸æƒ³æŠŠ markdown ç›´æ¥å…¬è«¸æ–¼ä¸–è©²æ€éº¼è¾¦ï¼Ÿ]]></summary></entry><entry><title type="html">[Linux] æŸ¥è©¢ä½”ç”¨ port çš„ pid</title><link href="https://blog.anxgang.com/linux-query-uses-the-pid-of-port/" rel="alternate" type="text/html" title="[Linux] æŸ¥è©¢ä½”ç”¨ port çš„ pid" /><published>2018-10-18T08:33:00+08:00</published><updated>2018-10-18T08:33:00+08:00</updated><id>https://blog.anxgang.com/linux-query-uses-the-pid-of-port</id><content type="html" xml:base="https://blog.anxgang.com/linux-query-uses-the-pid-of-port/"><![CDATA[<h2 id="æŸ¥è©¢ä½”ç”¨-port-çš„-pid">æŸ¥è©¢ä½”ç”¨ port çš„ pid</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ netstat -nlp|grep 8080
</code></pre></div></div>

<h2 id="æŸ¥è©¢-pid-ä½”ç”¨å“ªäº›-port">æŸ¥è©¢ pid ä½”ç”¨å“ªäº› port</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ netstat -pl | grep 6152
</code></pre></div></div>]]></content><author><name>anxgang</name></author><summary type="html"><![CDATA[æŸ¥è©¢ä½”ç”¨ port çš„ pid $ netstat -nlp|grep 8080 æŸ¥è©¢ pid ä½”ç”¨å“ªäº› port $ netstat -pl | grep 6152]]></summary></entry><entry><title type="html">[Postal] è‡ªå»ºå¤§é‡å¯„é€ä¿¡ä»¶ä¼ºæœå™¨</title><link href="https://blog.anxgang.com/postal-self-built-a-large-number-of-mail-sent-to-the-server/" rel="alternate" type="text/html" title="[Postal] è‡ªå»ºå¤§é‡å¯„é€ä¿¡ä»¶ä¼ºæœå™¨" /><published>2018-10-16T09:22:00+08:00</published><updated>2018-10-16T09:22:00+08:00</updated><id>https://blog.anxgang.com/postal-self-built-a-large-number-of-mail-sent-to-the-server</id><content type="html" xml:base="https://blog.anxgang.com/postal-self-built-a-large-number-of-mail-sent-to-the-server/"><![CDATA[<h1 id="postal">Postal</h1>

<h3 id="1-é–‹ä¸€å°-ubuntu-1604-lts">1. é–‹ä¸€å° Ubuntu 16.04 LTS</h3>
<h3 id="2-åŸ·è¡Œå¿«é€Ÿå®‰è£æŒ‡ä»¤">2. åŸ·è¡Œå¿«é€Ÿå®‰è£æŒ‡ä»¤</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl https://raw.githubusercontent.com/atech/postal/master/script/install/ubuntu1604.sh | sh	
</code></pre></div></div>

<h3 id="3-é–‹æ–°å¸³è™Ÿ">3. é–‹æ–°å¸³è™Ÿ</h3>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">postal</span> <span class="n">make</span><span class="o">-</span><span class="n">user</span>

<span class="c1"># E-Mail Address      : xxx@gmail.com</span>
<span class="c1"># First Name          : xxx</span>
<span class="c1"># Last Name           : xxx</span>
<span class="c1"># Initial Password:   : **********</span>
<span class="c1"># User has been created with e-mail address xxx@gmail.com</span>
</code></pre></div></div>

<h3 id="4-ä¿®æ”¹mysqlå¯†ç¢¼">4. ä¿®æ”¹mysqlå¯†ç¢¼</h3>
<p><code class="language-plaintext highlighter-rouge">mysqladmin -u root password</code></p>
<h3 id="5-ä¿®æ”¹rabbitmqå¯†ç¢¼">5. ä¿®æ”¹RabbitMQå¯†ç¢¼</h3>
<p><code class="language-plaintext highlighter-rouge">p0stalpassw0rd</code></p>

<blockquote>
  <p>mysql çš„ root å¯†ç¢¼é è¨­æ˜¯ç©ºçš„ï¼Œè¦è‡ªå·±è£œ
mysql å’Œ rabitMQ çš„ postalå¸³è™Ÿçš„å¯†ç¢¼è¦ä¸€æ¨£æ‰è¡Œ (ä¸å‹•ä¹Ÿæ²’å·®ï¼Œåæ­£æœƒåŠ é˜²ç«ç‰†)</p>
</blockquote>

<h3 id="6-æŠŠ-nginx-è¨­å®šè£¡é¢å…©å€‹domain-nameéƒ½æ”¹æ‰">6. æŠŠ nginx è¨­å®šè£¡é¢å…©å€‹domain nameéƒ½æ”¹æ‰</h3>

<p>/etc/nginx/sites-enabled/default</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domain_name postal.yourdomain.com
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ nginx -t
$ service nginx restart
</code></pre></div></div>

<h3 id="7-å®‰è£-certbot-ä¸¦å•Ÿç”¨ssl">7. å®‰è£ certbot ä¸¦å•Ÿç”¨ssl</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get update
$ sudo apt-get install software-properties-common
$ sudo add-apt-repository ppa:certbot/certbot
$ sudo apt-get update
$ sudo apt-get install python-certbot-nginx 
</code></pre></div></div>

<p>å•Ÿç”¨certbot</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$sudo certbot --nginx
# é¸ 1 ä¸è‡ªå‹•è½‰(åŸæœ¬å·²ç¶“å¯«å¥½äº†)
</code></pre></div></div>

<p>è¨­å®šè‡ªå‹•å•Ÿç”¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo certbot renew --dry-run
</code></pre></div></div>

<h3 id="8-dnsè¨­å®š">8. DNSè¨­å®š</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>;; A Records (IPv4 addresses)
yourdomain.com.	1	IN	A	123.123.123.123
postal.yourdomain.com.	1	IN	A	123.123.123.123
rp.mail.yourdomain.com.	1	IN	A	123.123.123.123
spf.postal.yourdomain.com.	1	IN	A	123.123.123.123
www.yourdomain.com.	1	IN	A	123.123.123.123
;; MX Records
psrp.yourdomain.com.	1	IN	MX	10	mx.postal.yourdomain.com.
psrp.mail.yourdomain.com.	1	IN	MX	10	mx.postal.yourdomain.com.
;; CNAME Records
psrp.yourdomain.com.	1	IN	CNAME	rp.postal.yourdomain.com.
psrp.mail.yourdomain.com.	1	IN	CNAME	rp.postal.yourdomain.com.
;; TXT Records
yourdomain.com.	1	IN	TXT	"v=spf1 a mx include:spf.postal.yourdomain.com ~all"
mail.yourdomain.com.	1	IN	TXT	"v=spf1 a mx include:spf.postal.yourdomain.com ~all"
psrp.yourdomain.com.	1	IN	TXT	"v=spf1 a mx ip4:123.123.123.123 ~all"
psrp.mail.yourdomain.com.	1	IN	TXT	"v=spf1 a mx ip4:123.123.123.123 ~all"
postal-bfyfsk._domainkey.yourdomain.com.	1	IN	TXT	"v=DKIM1; t=s; h=sha256; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDsEfl9HlDLTG9G4LVkVPh/mnCkb+XiJpeaGaVR/+TLHvdLv2EaVY9QlXnJl3CsOz+ift8W0cAQFfSRjHF4LHyGFxe0UfDOhMR67p4/KiCF3uq/bnSMnVXKLXp45YWGz9JT2HIlu497zZ1m7zIXtiSChU2qR39kTqai7CK8VHEOJQIDAQAB;"
postal-gmqito._domainkey.mail.yourdomain.com.	1	IN	TXT	"v=DKIM1; t=s; h=sha256; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCiduT7ecGnhzz/qgNQXYFmdIZ2tWyjg34z4GJJZxf6JNewYb9Ag776Ogcanux2s78G0JDYMo1M/HPekq1REEL3wPHU8yYsBG9xLcLSfr1wIMVqrZ7oLKsC3I8HsJOnARu3reQrpBIOq//4wei8mzUyNwhAfPrEvbVzgBhAcOe74wIDAQAB;"
postal-nofjiu._domainkey.mail.yourdomain.com.	1	IN	TXT	"v=DKIM1; t=s; h=sha256; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3ebXd1f8b8yXxWZegbMW/Pn7wppOslFxkDft4tCpY5QMlhiOkvBU4zy3BlpA+m930MDPyqeiIhFBHpLhEelwT50H3I7yMtI+fQb4+PVMwog9czLTN9wYWWomHNGI4bUo1GWPWbnjgPSyjEOM5mKIwk3Fvqgdyo6goNnjEjh4wWQIDAQAB;"
_dmarc.yourdomain.com.	1	IN	TXT	"v=DMARC1; p=none"
</code></pre></div></div>

<h3 id="9-smtp-è¨­å®šè½‰-port">9. smtp è¨­å®šè½‰ port</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```
$ sudo apt-get install ufw
# æ‰€æœ‰port å…è¨±é€å‡ºï¼Œæ‹’çµ•é€²å…¥
$ sudo ufw default deny incoming
$ sudo ufw default allow outgoing
# é–‹å•Ÿæœå‹™
$ sudo ufw allow ssh (å‹™å¿…åŠ å…¥ï¼Œå¦å‰‡ç„¡æ³•é ç«¯)
$ sudo ufw allow http
$ sudo ufw allow https
$ sudo ufw allow 587/tcp
```
</code></pre></div></div>

<p>è¨­å®š port forwarding</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># /etc/ufw/sysctl.conf
net/ipv4/ip_forward=1 #æŠŠè¨»è§£å–æ¶ˆ
</code></pre></div></div>

<p>æŠŠä»¥ä¸‹æ–‡å­—åŠ åˆ° <code class="language-plaintext highlighter-rouge">/etc/ufw/before.rules</code> æœ€ä¸Šæ–¹</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># /etc/ufw/before.rules 
*nat
:PREROUTING ACCEPT [0:0]
-A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080
COMMIT
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo ufw disable 
$ sudo ufw enable 
</code></pre></div></div>

<blockquote>
  <p>åƒè€ƒ</p>
  <ol>
    <li>https://serverfault.com/questions/238563/can-i-use-ufw-to-setup-a-port-forward</li>
  </ol>
</blockquote>]]></content><author><name>anxgang</name></author><summary type="html"><![CDATA[Postal 1. é–‹ä¸€å° Ubuntu 16.04 LTS 2. åŸ·è¡Œå¿«é€Ÿå®‰è£æŒ‡ä»¤ $ curl https://raw.githubusercontent.com/atech/postal/master/script/install/ubuntu1604.sh | sh 3. é–‹æ–°å¸³è™Ÿ $ postal make-user # E-Mail Address : xxx@gmail.com # First Name : xxx # Last Name : xxx # Initial Password: : ********** # User has been created with e-mail address xxx@gmail.com 4. ä¿®æ”¹mysqlå¯†ç¢¼ mysqladmin -u root password 5. ä¿®æ”¹RabbitMQå¯†ç¢¼ p0stalpassw0rd mysql çš„ root å¯†ç¢¼é è¨­æ˜¯ç©ºçš„ï¼Œè¦è‡ªå·±è£œ mysql å’Œ rabitMQ çš„ postalå¸³è™Ÿçš„å¯†ç¢¼è¦ä¸€æ¨£æ‰è¡Œ (ä¸å‹•ä¹Ÿæ²’å·®ï¼Œåæ­£æœƒåŠ é˜²ç«ç‰†) 6. æŠŠ nginx è¨­å®šè£¡é¢å…©å€‹domain nameéƒ½æ”¹æ‰ /etc/nginx/sites-enabled/default domain_name postal.yourdomain.com $ nginx -t $ service nginx restart 7. å®‰è£ certbot ä¸¦å•Ÿç”¨ssl $ sudo apt-get update $ sudo apt-get install software-properties-common $ sudo add-apt-repository ppa:certbot/certbot $ sudo apt-get update $ sudo apt-get install python-certbot-nginx å•Ÿç”¨certbot $sudo certbot --nginx # é¸ 1 ä¸è‡ªå‹•è½‰(åŸæœ¬å·²ç¶“å¯«å¥½äº†) è¨­å®šè‡ªå‹•å•Ÿç”¨ $ sudo certbot renew --dry-run 8. DNSè¨­å®š ;; A Records (IPv4 addresses) yourdomain.com. 1 IN A 123.123.123.123 postal.yourdomain.com. 1 IN A 123.123.123.123 rp.mail.yourdomain.com. 1 IN A 123.123.123.123 spf.postal.yourdomain.com. 1 IN A 123.123.123.123 www.yourdomain.com. 1 IN A 123.123.123.123 ;; MX Records psrp.yourdomain.com. 1 IN MX 10 mx.postal.yourdomain.com. psrp.mail.yourdomain.com. 1 IN MX 10 mx.postal.yourdomain.com. ;; CNAME Records psrp.yourdomain.com. 1 IN CNAME rp.postal.yourdomain.com. psrp.mail.yourdomain.com. 1 IN CNAME rp.postal.yourdomain.com. ;; TXT Records yourdomain.com. 1 IN TXT "v=spf1 a mx include:spf.postal.yourdomain.com ~all" mail.yourdomain.com. 1 IN TXT "v=spf1 a mx include:spf.postal.yourdomain.com ~all" psrp.yourdomain.com. 1 IN TXT "v=spf1 a mx ip4:123.123.123.123 ~all" psrp.mail.yourdomain.com. 1 IN TXT "v=spf1 a mx ip4:123.123.123.123 ~all" postal-bfyfsk._domainkey.yourdomain.com. 1 IN TXT "v=DKIM1; t=s; h=sha256; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDsEfl9HlDLTG9G4LVkVPh/mnCkb+XiJpeaGaVR/+TLHvdLv2EaVY9QlXnJl3CsOz+ift8W0cAQFfSRjHF4LHyGFxe0UfDOhMR67p4/KiCF3uq/bnSMnVXKLXp45YWGz9JT2HIlu497zZ1m7zIXtiSChU2qR39kTqai7CK8VHEOJQIDAQAB;" postal-gmqito._domainkey.mail.yourdomain.com. 1 IN TXT "v=DKIM1; t=s; h=sha256; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCiduT7ecGnhzz/qgNQXYFmdIZ2tWyjg34z4GJJZxf6JNewYb9Ag776Ogcanux2s78G0JDYMo1M/HPekq1REEL3wPHU8yYsBG9xLcLSfr1wIMVqrZ7oLKsC3I8HsJOnARu3reQrpBIOq//4wei8mzUyNwhAfPrEvbVzgBhAcOe74wIDAQAB;" postal-nofjiu._domainkey.mail.yourdomain.com. 1 IN TXT "v=DKIM1; t=s; h=sha256; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3ebXd1f8b8yXxWZegbMW/Pn7wppOslFxkDft4tCpY5QMlhiOkvBU4zy3BlpA+m930MDPyqeiIhFBHpLhEelwT50H3I7yMtI+fQb4+PVMwog9czLTN9wYWWomHNGI4bUo1GWPWbnjgPSyjEOM5mKIwk3Fvqgdyo6goNnjEjh4wWQIDAQAB;" _dmarc.yourdomain.com. 1 IN TXT "v=DMARC1; p=none" 9. smtp è¨­å®šè½‰ port ``` $ sudo apt-get install ufw # æ‰€æœ‰port å…è¨±é€å‡ºï¼Œæ‹’çµ•é€²å…¥ $ sudo ufw default deny incoming $ sudo ufw default allow outgoing # é–‹å•Ÿæœå‹™ $ sudo ufw allow ssh (å‹™å¿…åŠ å…¥ï¼Œå¦å‰‡ç„¡æ³•é ç«¯) $ sudo ufw allow http $ sudo ufw allow https $ sudo ufw allow 587/tcp ``` è¨­å®š port forwarding # /etc/ufw/sysctl.conf net/ipv4/ip_forward=1 #æŠŠè¨»è§£å–æ¶ˆ æŠŠä»¥ä¸‹æ–‡å­—åŠ åˆ° /etc/ufw/before.rules æœ€ä¸Šæ–¹ # /etc/ufw/before.rules *nat :PREROUTING ACCEPT [0:0] -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080 COMMIT $ sudo ufw disable $ sudo ufw enable åƒè€ƒ https://serverfault.com/questions/238563/can-i-use-ufw-to-setup-a-port-forward]]></summary></entry><entry><title type="html">[Rails] cookie overflow å•é¡Œè™•ç†</title><link href="https://blog.anxgang.com/rails-cookie-overflow-problem-handling/" rel="alternate" type="text/html" title="[Rails] cookie overflow å•é¡Œè™•ç†" /><published>2018-09-06T00:57:00+08:00</published><updated>2018-09-06T00:57:00+08:00</updated><id>https://blog.anxgang.com/rails-cookie-overflow-problem-handling</id><content type="html" xml:base="https://blog.anxgang.com/rails-cookie-overflow-problem-handling/"><![CDATA[<h2 id="éŒ¯èª¤è¨Šæ¯">éŒ¯èª¤è¨Šæ¯</h2>
<p>ActionDispatch::Cookies::CookieOverflow in UsersController#create</p>

<h2 id="è§£æ±ºæ–¹å¼">è§£æ±ºæ–¹å¼</h2>
<p>ä½¿ç”¨ active_record_store æˆ–æ˜¯ mem_record_store æŠŠ cookie å…§å®¹å¦å¤–å­˜èµ·ä¾†</p>

<p>æœ¬æ–‡ä½¿ç”¨ active_record_store è™•ç†</p>

<h2 id="è§£æ±ºæ­¥é©Ÿ">è§£æ±ºæ­¥é©Ÿ</h2>

<p>å®‰è£ gem</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem 'activerecord-session_store'
</code></pre></div></div>

<p>ç”¢ç”Ÿéœ€è¦ç”¨åˆ°çš„ migration</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rake db:sessions:create
rake db:migrate
</code></pre></div></div>

<p>config/initializers/session_store.rb ä¸­ï¼Œå°‡åŸæœ‰çš„ :cookie_store æ”¹ç‚º :active_record_store</p>
<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">session_store</span> <span class="ss">:cookie_store</span><span class="p">,</span> <span class="ss">:key</span> <span class="o">=&gt;</span> <span class="s1">'_my_app_session'</span>
<span class="n">to</span>
<span class="no">Application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">session_store</span> <span class="ss">:active_record_store</span><span class="p">,</span> <span class="ss">:key</span> <span class="o">=&gt;</span> <span class="s1">'_my_app_session'</span>
</code></pre></div></div>

<h2 id="åŠ å…¥å®šæ™‚åˆªé™¤æ’ç¨‹">åŠ å…¥å®šæ™‚åˆªé™¤æ’ç¨‹</h2>
<p>å®˜æ–¹å»ºè­° prodcution ç’°å¢ƒéœ€è¦å»ºç«‹æ’ç¨‹å®šæ™‚æ¸…ç† dbï¼Œé¿å…è³‡æ–™ä¸€ç›´å¢é•·
<a href="https://github.com/rails/activerecord-session_store/blob/f7463cbd82fe997759fe0622c84f14c7b9af9737/lib/tasks/database.rake">ç¨‹å¼åƒè€ƒ</a></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rake db:sessions:clear  --&gt; æ¸…ç©º session
rake db:sessions:trim   --&gt; æ¸…ç† 30 å¤©ä»¥å‰çš„ session
</code></pre></div></div>

<p>å¯ä»¥åœ¨ sidekiq å¡ä¸€å€‹ job åŸ·è¡Œ</p>
<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutoff_period</span> <span class="o">=</span> <span class="p">(</span><span class="no">ENV</span><span class="p">[</span><span class="s1">'SESSION_DAYS_TRIM_THRESHOLD'</span><span class="p">]</span> <span class="o">||</span> <span class="mi">30</span><span class="p">).</span><span class="nf">to_i</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span>
<span class="no">ActiveRecord</span><span class="o">::</span><span class="no">SessionStore</span><span class="o">::</span><span class="no">Session</span><span class="p">.</span>
      <span class="nf">where</span><span class="p">(</span><span class="s2">"updated_at &lt; ?"</span><span class="p">,</span> <span class="n">cutoff_period</span><span class="p">).</span>
      <span class="nf">delete_all</span>
</code></pre></div></div>

<blockquote>
  <p>åƒè€ƒ</p>
  <ol>
    <li>https://github.com/rails/activerecord-session_store</li>
    <li>https://stackoverflow.com/questions/9473808/cookie-overflow-in-rails-application</li>
    <li>http://railscasts.com/episodes/127-rake-in-background</li>
  </ol>
</blockquote>]]></content><author><name>anxgang</name></author><summary type="html"><![CDATA[éŒ¯èª¤è¨Šæ¯ ActionDispatch::Cookies::CookieOverflow in UsersController#create è§£æ±ºæ–¹å¼ ä½¿ç”¨ active_record_store æˆ–æ˜¯ mem_record_store æŠŠ cookie å…§å®¹å¦å¤–å­˜èµ·ä¾† æœ¬æ–‡ä½¿ç”¨ active_record_store è™•ç† è§£æ±ºæ­¥é©Ÿ å®‰è£ gem gem 'activerecord-session_store' ç”¢ç”Ÿéœ€è¦ç”¨åˆ°çš„ migration rake db:sessions:create rake db:migrate config/initializers/session_store.rb ä¸­ï¼Œå°‡åŸæœ‰çš„ :cookie_store æ”¹ç‚º :active_record_store Application.config.session_store :cookie_store, :key =&gt; '_my_app_session' to Application.config.session_store :active_record_store, :key =&gt; '_my_app_session' åŠ å…¥å®šæ™‚åˆªé™¤æ’ç¨‹ å®˜æ–¹å»ºè­° prodcution ç’°å¢ƒéœ€è¦å»ºç«‹æ’ç¨‹å®šæ™‚æ¸…ç† dbï¼Œé¿å…è³‡æ–™ä¸€ç›´å¢é•· ç¨‹å¼åƒè€ƒ rake db:sessions:clear --&gt; æ¸…ç©º session rake db:sessions:trim --&gt; æ¸…ç† 30 å¤©ä»¥å‰çš„ session å¯ä»¥åœ¨ sidekiq å¡ä¸€å€‹ job åŸ·è¡Œ cutoff_period = (ENV['SESSION_DAYS_TRIM_THRESHOLD'] || 30).to_i.days.ago ActiveRecord::SessionStore::Session. where("updated_at &lt; ?", cutoff_period). delete_all åƒè€ƒ https://github.com/rails/activerecord-session_store https://stackoverflow.com/questions/9473808/cookie-overflow-in-rails-application http://railscasts.com/episodes/127-rake-in-background]]></summary></entry><entry><title type="html">[Rails] ä¿®æ”¹é è¨­çš„ scaffold æ¨¡æ¿</title><link href="https://blog.anxgang.com/rails-modifies-the-default-scaffold-template/" rel="alternate" type="text/html" title="[Rails] ä¿®æ”¹é è¨­çš„ scaffold æ¨¡æ¿" /><published>2018-09-03T01:33:00+08:00</published><updated>2018-09-03T01:33:00+08:00</updated><id>https://blog.anxgang.com/rails-modifies-the-default-scaffold-template</id><content type="html" xml:base="https://blog.anxgang.com/rails-modifies-the-default-scaffold-template/"><![CDATA[<h2 id="ä¿®æ”¹-model">ä¿®æ”¹ model</h2>
<p>app/lib/templates/active_record/model/model.rb
<a href="https://github.com/rails/rails/blob/master/activerecord/lib/rails/generators/active_record/model/templates/model.rb.tt">å®˜æ–¹ç¯„ä¾‹</a></p>

<h2 id="ä¿®æ”¹-view">ä¿®æ”¹ view</h2>
<p>app/lib/templates/scaffold/_form.html.erb
app/lib/templates/scaffold/edit.html.erb
app/lib/templates/scaffold/index.html.erb
app/lib/templates/scaffold/new.html.erb
app/lib/templates/scaffold/show.html.erb
<a href="https://github.com/rails/rails/tree/b2eb1d1c55a59fee1e6c4cba7030d8ceb524267c/railties/lib/rails/generators/erb/scaffold/templates">å®˜æ–¹ç¯„ä¾‹</a>
<!-- more --></p>
<h2 id="ä¿®æ”¹-controller">ä¿®æ”¹ controller</h2>
<p>app/lib/scaffold_controller/controller.rb
<a href="https://github.com/rails/rails/blob/b2eb1d1c55a59fee1e6c4cba7030d8ceb524267c/railties/lib/rails/generators/rails/scaffold_controller/templates/controller.rb.tt">å®˜æ–¹ç¯„ä¾‹</a></p>

<h2 id="ä¿®æ”¹-rspec">ä¿®æ”¹ rspec</h2>
<p>app/lib/templates/rspec/scaffold/controller_spec.rb
<a href="https://github.com/rspec/rspec-rails/blob/master/lib/generators/rspec/scaffold/templates/controller_spec.rb">å®˜æ–¹ç¯„ä¾‹</a></p>

<h2 id="å¯«æ³•">å¯«æ³•</h2>
<p><code class="language-plaintext highlighter-rouge">&lt;%% %&gt;</code> ä»£è¡¨å¯ä»¥ç”¢ç”Ÿrailsèªæ³•
åœ¨è£¡é¢å¯ä»¥å¡ <code class="language-plaintext highlighter-rouge">&lt;% %&gt;</code> è®Šæ•¸ èªæ³•</p>

<p>ä¾‹å¦‚ï¼š</p>
<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%%</span><span class="o">=</span> <span class="n">link_to</span> <span class="s1">'edit'</span><span class="p">,</span> <span class="n">edit_</span><span class="o">&lt;</span><span class="sx">%= singular_table_name </span><span class="cp">%&gt;</span>_path(<span class="cp">&lt;%=</span><span class="sx"> singular_table_name </span><span class="cp">%&gt;</span>) %&gt;
</code></pre></div></div>
<p>æœ€å¾Œç”¢ç”Ÿçš„ template æœƒæ˜¯</p>
<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'edit'</span><span class="p">,</span> <span class="n">edit_user_path</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<h2 id="è®Šæ•¸æ•´ç†">è®Šæ•¸æ•´ç†</h2>
<p>å‡è¨­ <code class="language-plaintext highlighter-rouge">rails g scaffold System::ModelName attr1 attr2</code></p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">application_name:       </span><span class="n">my_app</span>
<span class="ss">attributes_names:       </span><span class="p">[</span><span class="s2">"attr1"</span><span class="p">,</span> <span class="s2">"attr2"</span><span class="p">]</span>
<span class="ss">class_path:             </span><span class="p">[</span><span class="s2">"system"</span><span class="p">]</span>
<span class="ss">regular_class_path:     </span><span class="p">[</span><span class="s2">"system"</span><span class="p">]</span>

<span class="ss">singular_name:          </span><span class="n">model_name</span>
<span class="ss">plural_name:            </span><span class="n">model_names</span>
<span class="ss">human_name:             </span><span class="no">Model</span> <span class="nb">name</span>
<span class="ss">plural_file_name:       </span><span class="n">model_names</span>
<span class="ss">fixture_file_name:      </span><span class="n">model_names</span>

<span class="ss">class_name:             </span><span class="no">System</span><span class="o">::</span><span class="no">ModelName</span>
<span class="ss">file_path:              </span><span class="nb">system</span><span class="o">/</span><span class="n">model_name</span>
<span class="ss">i18n_scope:             </span><span class="nb">system</span><span class="p">.</span><span class="nf">model_name</span>
<span class="ss">model_resource_name:    </span><span class="n">system_model_name</span>
<span class="ss">singular_route_name:    </span><span class="n">system_model_name</span>
<span class="ss">singular_table_name:    </span><span class="n">system_model_name</span>
<span class="ss">plural_route_name:      </span><span class="n">system_model_names</span>
<span class="ss">plural_table_name:      </span><span class="n">system_model_names</span>
<span class="ss">table_name:             </span><span class="n">system_model_names</span>
<span class="ss">redirect_resource_name: </span><span class="vi">@system_model_name</span>
<span class="ss">route_url:              </span><span class="sr">/system/mo</span><span class="n">del_names</span>

<span class="ss">url_helper_prefix:      </span><span class="n">system_model_name</span>
<span class="ss">index_helper:           </span><span class="n">system_model_names</span>
<span class="ss">new_helper:             </span><span class="n">new_system_model_name_url</span>
<span class="ss">edit_helper:            </span><span class="n">edit_system_model_name_url</span><span class="p">(</span><span class="vi">@system_model_name</span><span class="p">)</span>
<span class="ss">show_helper:            </span><span class="n">system_model_name_url</span><span class="p">(</span><span class="vi">@system_model_name</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="æ•…éšœæ’é™¤">æ•…éšœæ’é™¤</h2>

<p>Q1. èª¿æ•´å¾Œç”¢ç”Ÿscaffoldï¼Œä½†æ˜¯æ¨¡æ¿æ²’è®Š
Ans.: é ˆå…ˆåŸ·è¡Œ <code class="language-plaintext highlighter-rouge">spring stop</code> å†ç”¢ç”Ÿscaffold</p>

<blockquote>
  <p>åƒè€ƒ</p>
  <ol>
    <li>https://api.rubyonrails.org/classes/Rails/Generators/NamedBase.html#method-i-application_name</li>
  </ol>
</blockquote>]]></content><author><name>anxgang</name></author><summary type="html"><![CDATA[ä¿®æ”¹ model app/lib/templates/active_record/model/model.rb å®˜æ–¹ç¯„ä¾‹ ä¿®æ”¹ view app/lib/templates/scaffold/_form.html.erb app/lib/templates/scaffold/edit.html.erb app/lib/templates/scaffold/index.html.erb app/lib/templates/scaffold/new.html.erb app/lib/templates/scaffold/show.html.erb å®˜æ–¹ç¯„ä¾‹ ä¿®æ”¹ controller app/lib/scaffold_controller/controller.rb å®˜æ–¹ç¯„ä¾‹ ä¿®æ”¹ rspec app/lib/templates/rspec/scaffold/controller_spec.rb å®˜æ–¹ç¯„ä¾‹ å¯«æ³• &lt;%% %&gt; ä»£è¡¨å¯ä»¥ç”¢ç”Ÿrailsèªæ³• åœ¨è£¡é¢å¯ä»¥å¡ &lt;% %&gt; è®Šæ•¸ èªæ³• ä¾‹å¦‚ï¼š &lt;%%= link_to 'edit', edit_&lt;%= singular_table_name %&gt;_path(&lt;%= singular_table_name %&gt;) %&gt; æœ€å¾Œç”¢ç”Ÿçš„ template æœƒæ˜¯ &lt;%= link_to 'edit', edit_user_path(user) %&gt; è®Šæ•¸æ•´ç† å‡è¨­ rails g scaffold System::ModelName attr1 attr2 application_name: my_app attributes_names: ["attr1", "attr2"] class_path: ["system"] regular_class_path: ["system"] singular_name: model_name plural_name: model_names human_name: Model name plural_file_name: model_names fixture_file_name: model_names class_name: System::ModelName file_path: system/model_name i18n_scope: system.model_name model_resource_name: system_model_name singular_route_name: system_model_name singular_table_name: system_model_name plural_route_name: system_model_names plural_table_name: system_model_names table_name: system_model_names redirect_resource_name: @system_model_name route_url: /system/model_names url_helper_prefix: system_model_name index_helper: system_model_names new_helper: new_system_model_name_url edit_helper: edit_system_model_name_url(@system_model_name) show_helper: system_model_name_url(@system_model_name) æ•…éšœæ’é™¤ Q1. èª¿æ•´å¾Œç”¢ç”Ÿscaffoldï¼Œä½†æ˜¯æ¨¡æ¿æ²’è®Š Ans.: é ˆå…ˆåŸ·è¡Œ spring stop å†ç”¢ç”Ÿscaffold åƒè€ƒ https://api.rubyonrails.org/classes/Rails/Generators/NamedBase.html#method-i-application_name]]></summary></entry><entry><title type="html">[Rails] model ä¸­å–å¾— current_user</title><link href="https://blog.anxgang.com/get-current-user-in-rails-model/" rel="alternate" type="text/html" title="[Rails] model ä¸­å–å¾— current_user" /><published>2018-08-30T07:18:00+08:00</published><updated>2018-08-30T07:18:00+08:00</updated><id>https://blog.anxgang.com/get-current-user-in-rails-model</id><content type="html" xml:base="https://blog.anxgang.com/get-current-user-in-rails-model/"><![CDATA[<h2 id="æ–½ä½œæ–¹å¼">æ–½ä½œæ–¹å¼</h2>
<h5 id="1-è¨­å®š-usercurrent">1. è¨­å®š User.current</h5>

<p>user.rb</p>
<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">current</span>
    <span class="no">Thread</span><span class="p">.</span><span class="nf">current</span><span class="p">[</span><span class="ss">:user</span><span class="p">]</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">current</span><span class="o">=</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
    <span class="no">Thread</span><span class="p">.</span><span class="nf">current</span><span class="p">[</span><span class="ss">:user</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>application_controller.rb</p>
<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">before_action</span> <span class="ss">:set_current_user</span>

  <span class="k">def</span> <span class="nf">set_current_user</span>
    <span class="no">User</span><span class="p">.</span><span class="nf">current</span> <span class="o">=</span> <span class="n">current_user</span> 
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<blockquote>
  <p>åƒè€ƒ</p>
  <ol>
    <li>https://stackoverflow.com/questions/3742785/rails-3-devise-current-user-is-not-accessible-in-a-model#3742981</li>
    <li>https://amitrmohanty.wordpress.com/2014/01/20/how-to-get-current_user-in-model-and-observer-rails/</li>
  </ol>
</blockquote>]]></content><author><name>anxgang</name></author><summary type="html"><![CDATA[æ–½ä½œæ–¹å¼ 1. è¨­å®š User.current user.rb class User &lt; ApplicationRecord def self.current Thread.current[:user] end def self.current=(user) Thread.current[:user] = user end end application_controller.rb class ApplicationController &lt; ActionController::Base before_action :set_current_user def set_current_user User.current = current_user end end åƒè€ƒ https://stackoverflow.com/questions/3742785/rails-3-devise-current-user-is-not-accessible-in-a-model#3742981 https://amitrmohanty.wordpress.com/2014/01/20/how-to-get-current_user-in-model-and-observer-rails/]]></summary></entry></feed>